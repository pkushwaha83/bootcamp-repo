Sub StockTest()

Dim ws As Worksheet
    For Each ws In ActiveWorkbook.Worksheets
    ws.Activate

    Dim TickerName As String
    Dim TotalVolumn As Double
    TotalVolumn = 0
    Dim col As Integer
    col = 1
    Dim TickerRow As Integer
    TickerRow = 2
    Dim OpenPrice As Double
    Dim ClosePrice As Double
    Dim YearlyChange As Double
    Dim PercentChange As Double
    
    
    
     ' Add Heading for summary
        Cells(1, "I").Value = "Ticker"
        Cells(1, "J").Value = "Total Stock Volume"
        Cells(1, "K").Value = "Yearly Change"
        Cells(1, "L").Value = "Percentage Change"
    
    
    Lastrow = ws.Cells(Rows.Count, 1).End(xlUp).row
    
    OpenPrice = Cells(2, 3).Value
    
    For i = 2 To Lastrow
    
       If Cells(i + 1, col).Value <> Cells(i, col).Value Then
       
             'Add Ticker name
             TickerName = Cells(i, col).Value
             Cells(TickerRow, col + 8).Value = TickerName
            
             'Add Total Volumn
             TotalVolumn = TotalVolumn + Cells(i, 7).Value
             Cells(TickerRow, col + 9).Value = TotalVolumn
             
             'Add Yearly Changes
             ClosePrice = Cells(i, 6).Value
             YearlyChange = ClosePrice - OpenPrice
             
             Cells(TickerRow, col + 10).Value = YearlyChange
             
             'Add Percentage
             
             PercentChange = YearlyChange / OpenPrice
             Cells(TickerRow, col + 11).Value = PercentChange
             Cells(TickerRow, col + 11).NumberFormat = "0.00%"
             
            
            
            TickerRow = TickerRow + 1
            
            'reset the Open Price
            OpenPrice = Cells(i + 1, col + 2)
            
            TotalVolumn = 0
       
       Else
       
            TotalVolumn = TotalVolumn + Cells(i, 7).Value
       
       End If
    
    
    Next i
    
    ' Determine the Last Row of Yearly Change per WS
        YCLastRow = ws.Cells(Rows.Count, 10).End(xlUp).row
        ' Set the Cell Colors
        For j = 2 To YCLastRow
            If (Cells(j, 11).Value > 0 Or Cells(j, 11).Value = 0) Then
                Cells(j, 11).Interior.ColorIndex = 10
            ElseIf Cells(j, 11).Value < 0 Then
                Cells(j, 11).Interior.ColorIndex = 3
            End If
        Next j

    Next ws


End Sub
